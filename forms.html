<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<title>Question√°rio Psicopedag√≥gico</title>

<style>
:root {
  --primary:#2b7cff;
  --secondary:#6c63ff;
  --background:#f4f7fb;
  --card-bg:#ffffff;
  --text:#333;
}

body{
  font-family: 'Segoe UI', Arial, sans-serif;
  background:var(--background);
  padding:30px;
  color:var(--text);
  line-height:1.6;
}

h1{
  text-align:center;
  color:var(--primary);
  margin-bottom:30px;
}

.card{
  background:var(--card-bg);
  padding:20px;
  border-radius:12px;
  margin-bottom:20px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}

.question{
  margin:10px 0;
  font-weight:500;
}

.opcao{
  display:inline-block;
  margin:10px;
}

.opcao input[type="radio"]{
  display:none; /* escondemos o radio padr√£o */
}

.opcao label{
  display:inline-block;
  padding:12px 20px;
  border-radius:8px;
  background:#e0e7ff;
  color:#333;
  font-size:15px;
  cursor:pointer;
  transition: all 0.3s ease;
  border:2px solid transparent;
}

.opcao input[type="radio"]:checked + label{
  background:var(--secondary);
  color:white;
  border-color:var(--primary);
  font-weight:bold;
}

button{
  padding:16px 35px;
  border:none;
  background:var(--primary);
  color:white;
  border-radius:10px;
  font-size:18px;
  cursor:pointer;
  transition: background 0.3s ease, transform 0.2s ease;
}
button:hover{
  background:var(--secondary);
  transform: scale(1.05);
}

.resultado{
  font-size:20px;
  margin-top:25px;
  font-weight:bold;
  text-align:center;
  color:var(--secondary);
}
</style>
</head>

<body>

<h1>üìä Question√°rio de Avalia√ß√£o Comportamental</h1>

<form id="formulario"></form>

<div style="text-align:center; margin-top:20px;">
<button onclick="calcular()">Enviar respostas</button>
</div>

<div class="resultado" id="resultado"></div>

<script>
const opcoes = [
  {texto:"Nenhum", valor:0},
  {texto:"Pouco", valor:1},
  {texto:"Razo√°vel", valor:2},
  {texto:"Muito", valor:3}
];

const perguntas = [
"Constantemente se movendo (mesmo quando sentado)",
"Emite sons, ru√≠dos",
"Pedidos precisam ser imediatamente atendidos",
"Irrequieto",
"Excit√°vel, impulsivo",
"Desatento, facilmente distra√≠do",
"N√£o termina o que come√ßa",
"Extremamente sens√≠vel",
"Extremamente s√©rio ou triste",
"Mal-humorado, rabugento",
"Chora com frequ√™ncia",
"Perturba outras crian√ßas",
"Provoca confus√£o",
"Humor muda com rapidez",
"Matreiro, faz de esperto",
"Destrutivo",
"Mente",
"Explos√µes de raiva ou comportamento explosivo",
"Isola-se de outras crian√ßas",
"Parece n√£o ser aceito pelo grupo",
"N√£o tem esp√≠rito esportivo",
"Parece n√£o ter lideran√ßa",
"N√£o se relaciona bem com o sexo oposto",
"N√£o se relaciona bem com o mesmo sexo",
"Provoca outras crian√ßas ou interfere nas atividades",
"Submissa",
"Desafiadora",
"Atrevida",
"T√≠mida",
"Medrosa",
"Exige muita aten√ß√£o do professor",
"Teimosa",
"Dificuldade de concentra√ß√£o nos deveres escolares",
"Dificuldade de se fixar em uma brincadeira",
"Sempre mudando de atividade",
"Dificuldade de organizar tarefas",
"Grita em sala",
"Dificuldade de esperar sua vez",
"Sempre correndo ou pulando",
"Parece movido a motor",
"Responde antes da pergunta terminar",
"Dificuldade de brincar quieta",
"Fala excessivamente",
"Interrompe atividades dos outros",
"Parece n√£o prestar aten√ß√£o",
"Perde objetos com frequ√™ncia",
"Participa de tarefas perigosas sem pensar",
"Trabalha de forma independente",
"Persiste em tarefas por bom tempo",
"Completa deveres com pouca assist√™ncia",
"Segue instru√ß√µes simples corretamente",
"Funciona bem em sala de aula",
"Executa sequ√™ncia de instru√ß√µes",
"Comporta-se bem com colegas",
"Comunica√ß√£o verbal clara",
"Comunica√ß√£o n√£o verbal correta",
"Compreende normas sociais",
"Sabe fazer amigos",
"Enfrenta situa√ß√µes confiante",
"Tenta envolver outros em confus√µes",
"Come√ßa brigas sem motivo",
"Ridiculariza outros de modo malicioso"
];

const form = document.getElementById("formulario");

perguntas.forEach((p,i)=>{
  let div = document.createElement("div");
  div.className="card";

  let html = `<div class="question"><b>${i+1}.</b> ${p}<br/>`;

  opcoes.forEach(op=>{
    html += `
      <div class="opcao">
        <input type="radio" id="q${i}_${op.valor}" name="q${i}" value="${op.valor}" required>
        <label for="q${i}_${op.valor}">${op.texto}</label>
      </div>
    `;
  });

  html += `</div>`;
  div.innerHTML = html;
  form.appendChild(div);
});

function calcular(event) {
  event.preventDefault();

  let total = 0;
  const max = perguntas.length * 3;
  const respostas = [];

  for (let i = 0; i < perguntas.length; i++) {
    const v = document.querySelector(`input[name="q${i}"]:checked`);
    if (!v) {
      alert("Por favor, responda todas as perguntas antes de enviar.");
      return;
    }
    const valor = parseInt(v.value);
    total += valor;
    respostas.push(valor);
  }

  const porcentagem = ((total / max) * 100).toFixed(1);

  document.getElementById("resultado").innerHTML = 
    `‚úÖ Pontua√ß√£o: ${total} / ${max} <br> üìà Risco estimado: ${porcentagem}%`;

  // Envio para o Google Apps Script
  const payload = {
    idPaciente: prompt("Digite um ID ou nome do paciente (opcional):") || "An√¥nimo",
    total: total,
    porcentagem: porcentagem,
    respostas: respostas
  };

  fetch("https://script.google.com/macros/s/AKfycbzQDlkppRi6uxumn8AXhalqjqB-Ppb_Qgl1UaLNhfpwusqkO1AivSUfL6wF29pLP-it/exec", {
    method: "POST",
    headers: {
      "Content-Type": "text/plain;charset=utf-8"
    },
    body: JSON.stringify(payload),
    redirect: "follow"
  })
  .then(response => {
    if (!response.ok) {
      throw new Error(`Erro HTTP: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    alert("‚úÖ Respostas enviadas com sucesso! " + (data.message || ""));
  })
  .catch(err => {
    console.error("Erro ao enviar:", err);
    alert("‚ùå Erro ao enviar as respostas.\nDetalhes: " + err.message + "\nVerifique o console (F12) para mais informa√ß√µes.");
  });
}

// Impede o comportamento padr√£o do bot√£o se n√£o for chamado via onclick
document.querySelector('button').addEventListener('click', calcular);
</script>

</body>
</html>